# Week 4B - Review and more canvas

## I. Let's build a game! Breakout!

### Concepts covered
- Drawing: rectangles, arcs, text
- Animation with [`window.requestAnimationFrame()`](https://developer.mozilla.org/en-US/docs/Web/API/Window/requestAnimationFrame) or [`window.setTimeout()`](https://developer.mozilla.org/en-US/docs/Web/API/Window/setTimeout)
- Mouse control of paddle
- Playing audio with [WebAudio API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API)
- Refactoring code into [ES6 modules](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules)

---

### I-A. Get started on "Breakout 1"!

**breakout-1.html**

- Note that the script `type` is `"module"`
  - thus we no longer need `"use strict"` or `window.onload`
- There's a little bit of CSS
- Our drawing context is established
- The background is a black rectangle
- We've got some handy constants for later

```html
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Breakout</title>
	<style>
  body{
    background-color: #444;
  }
	canvas{
		border:2px solid #fff;;
	}
	</style>
	<script type="module">
    const canvas = document.querySelector("canvas");
    const ctx = canvas.getContext("2d");

    // Game Constants
    const BG_COLOR = "black";
    const PADDLE_COLOR = "limegreen";
    const PADDLE_WIDTH = 100;
    const PADDLE_HEIGHT = 10;
    const BALL_COLOR = "#FF0077";
    const BALL_SPEED = 10;

    // Game Objects

    // Functions
    const draw = () => {
      // Draw Background
      ctx.fillStyle = BG_COLOR;
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      // Draw Paddle
      
      // Draw Ball
      
    };

    draw();
	</script>
</head>
<body>
	<canvas width="640" height="480">
		Get a real browser!
	</canvas>
</body>
</html>
```

---

### I-B, Draw the the ball and get it moving

- Here's the ball data:

```js
// Game Objects
const ball = { x: 300, y: 430, dx: 0, dy: -BALL_SPEED, radius: 8 };
```
- ***YOU DO -->*** Now go ahead and fill the ball with `ctx.arc()` and `ctx.fill()` (see CS-2 for a reminder)
- To get the ball moving, we need an `update()` function, and a `loop()` function

```js
const update = () => {
  // Move ball
  ball.x += ball.dx;
  ball.y += ball.dy;
};

const loop = () => {
  update();
  draw();
};
```

- ***YOU DO -->*** test `loop()` with window.onclick = loop;
- ***YOU DO -->*** add a single line of code to `loop()` to get it to animating without clicking
  - utilize `setTimeout` or `requestAnimationFrame`
- ***YOU DO -->*** write another line of code to kick off the animation
- And here's the collision code for the top of the screen - add this to `update()`:
  
```js
// Wall Collisions (Top)
if (ball.y - ball.radius < 0) {
  ball.dy *= -1;
}
```

---

### I-C. Draw the the paddle and get it moving

- Here's paddle data:

```js
// Game Objects
const paddle = { x: 250, y: 460, width: PADDLE_WIDTH, height: PADDLE_HEIGHT };
```
- ***YOU DO -->*** It's a rectangle, go ahead and fill it with `ctx.fillRect()`
- Let's write some code that moves the paddle so that it follows the mouse pointer's location in the window - put this code near the bottom, right before the call to `loop()`:

```js
// Init
// Track mouse movement
//console.log(canvas.getBoundingClientRect().left);
document.onmousemove = (e) => {
  const rect = canvas.getBoundingClientRect();
  //  console.log(e.clientX); // x in document coordinates
  paddle.x = e.clientX - rect.left - paddle.width / 2;
};
```
- Docs:
  - https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect
  - https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/clientX





---

## II. Upcoming Assignments
- [PE-05 - Canvas Screensaver](../pe/pe-05.md) (covers Canvas Essential Skills #3-#5)
- [PE-06 - Algorithmic Botany](../pe/pe-06.md)
- [PE-07 - Audio Visualizer](../pe/pe-07.md)


---
---


| <-- Previous Unit | Home | Next Unit -->
| --- | --- | --- 
| [**Week 4A Notes**](04A.md)  |  [**IGME-330 Schedule**](../schedule.md) | Week 5A Notes
